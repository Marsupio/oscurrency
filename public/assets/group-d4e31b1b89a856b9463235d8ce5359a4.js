function update_topic(){topic_id=$("#topic").attr("data-id"),after=$(".forum_post:first-child").attr("data-time"),$.getScript("/posts?topic_id="+topic_id+"&after="+after)}var OSCURRENCY={};[].indexOf||(Array.prototype.indexOf=function(a,b){b=b==null?0:b;var c=this.length;for(var d=b;d<c;d++)if(this[d]==a)return d;return-1}),$(function(){function b(){return path=window.location.pathname,a=path.split("/"),a[2]}function c(a,b,c){r={tab:OSCURRENCY.tab_prefix+a,path:b,url:c},OSCURRENCY.routes.push(r)}function d(a){var b=[],c="",d="";for(i=0;i<OSCURRENCY.routes.length;i++){r=OSCURRENCY.routes[i];if(b=a.match(r.path)){d=r.tab,c=r.url.replace(/\[:group_id\]/,OSCURRENCY.group_id);for(j=1;j<b.length;j++)c=c.replace("[:"+j+"]",b[j]);return[d,c]}}return["",""]}function e(a){var b=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/;return b.exec(a)}function f(b){names=["url","scheme","slash","host","port","path","query","hash"],result=e(b),path=result[names.indexOf("path")],query=result[names.indexOf("query")],hash="#",a=path.split("/");for(i=0;i<parseInt(a.length/2);i++)i>0&&hash.length>1&&(hash+="/"),a[i*2]!="groups"&&(hash+=a[i*2]+"/"+a[i*2+1]);parseInt(a.length/2)!=a.length/2&&(hash.length>1&&(hash+="/"),hash+=a[a.length-1]);if(query!=undefined&&query.length>0){var c=query.split("&");for(i=0;i<c.length;i++)c[i].split("=")[0]!="group"&&(hash+="/"+c[i])}return hash}function g(a,b){var c="";return"all"==a&&-1==b.indexOf("edit")&&-1==b.indexOf("new")&&(c=-1==b.indexOf("?")?"?scope=all":"&scope=all"),c}function h(a){a!=OSCURRENCY.offers_mode&&(OSCURRENCY.offers_mode=a,"#offers"==window.location.hash?window.location.hash="#offers/page=1":window.location.hash="#offers")}function k(a){a!=OSCURRENCY.reqs_mode&&(OSCURRENCY.reqs_mode=a,"#requests"==window.location.hash?window.location.hash="#reqs/page=1":window.location.hash="#requests")}OSCURRENCY.group_id=b(),OSCURRENCY.routes=[],OSCURRENCY.tab_prefix="#tab_",OSCURRENCY.tab="",OSCURRENCY.post_allowed=!0,OSCURRENCY.notice_fadeout_time=8e3,OSCURRENCY.delete_fadeout_time=4e3,OSCURRENCY.offers_mode="",OSCURRENCY.reqs_mode="",$("#tabs").tabs({select:function(a,b){OSCURRENCY.tab=b.tab.hash},fx:{}}),$("ul.ui-tabs-nav").show(),c("home",/^#home$/,"/groups/[:group_id]"),c("home",/^#member_preferences\/(\d+)\/edit$/,"/member_preferences/[:1]/edit"),c("home",/^#graphs$/,"/groups/[:group_id]/graphs"),c("exchanges",/^#exchanges\/page=(\d+)/,"/groups/[:group_id]/exchanges?page=[:1]"),c("requests",/^#reqs\/page=(\d+)/,"/groups/[:group_id]/reqs?page=[:1]"),c("offers",/^#offers\/page=(\d+)/,"/groups/[:group_id]/offers?page=[:1]"),c("people",/^#people\/page=(\d+)/,"/groups/[:group_id]/memberships?page=[:1]"),c("forum",/^#forum\/page=(\d+)/,"/groups/[:group_id]/forum?page=[:1]"),c("requests",/^#reqs\/(\d+)$/,"/reqs/[:1]"),c("requests",/^#reqs\/(\d+)\/edit$/,"/reqs/[:1]/edit"),c("requests",/^#reqs\/new$/,"/groups/[:group_id]/reqs/new"),c("offers",/^#offers\/(\d+)$/,"/offers/[:1]"),c("offers",/^#offers\/(\d+)\/edit$/,"/offers/[:1]/edit"),c("offers",/^#offers\/new$/,"/groups/[:group_id]/offers/new"),c("people",/^#people\/(.+)\/exchanges\/new$/,"/people/[:1]/exchanges/new?group="+OSCURRENCY.group_id),c("offers",/^#people\/(.+)\/exchanges\/new\/offer=(\d+)$/,"/people/[:1]/exchanges/new?offer=[:2]"),c("people",/^#people\/(.+)\/messages\/new$/,"/people/[:1]/messages/new"),c("people",/^#people\/(.+)\/accounts\/(\d+)/,"/people/[:1]/accounts/[:2]"),c("people",/^#memberships\/(\d+)$/,"/memberships/[:1]"),c("forum",/^#forums\/(\d+)\/topics\/(\d+)$/,"/forums/[:1]/topics/[:2]"),c("forum",/^#forums\/(\d+)\/topics\/(\d+)\/page=(\d+)$/,"/forums/[:1]/topics/[:2]?page=[:3]"),c("exchanges",/^#exchanges$/,"/groups/[:group_id]/exchanges"),c("forum",/^#forum$/,"/groups/[:group_id]/forum"),c("requests",/^#requests$/,"/groups/[:group_id]/reqs"),c("requests",/^#requests\/category_id=$/,"/groups/[:group_id]/reqs"),c("requests",/^#requests\/category_id=(\d+)$/,"/groups/[:group_id]/reqs?category_id=[:1]"),c("requests",/^#reqs\/category_id=(\d+)\/page=(\d+)$/,"/groups/[:group_id]/reqs?category_id=[:1]&page=[:2]"),c("requests",/^#requests\/neighborhood_id=$/,"/groups/[:group_id]/reqs"),c("requests",/^#requests\/neighborhood_id=(\d+)$/,"/groups/[:group_id]/reqs?neighborhood_id=[:1]"),c("requests",/^#reqs\/neighborhood_id=(\d+)\/page=(\d+)$/,"/groups/[:group_id]/reqs?neighborhood_id=[:1]&page=[:2]"),c("offers",/^#offers$/,"/groups/[:group_id]/offers"),c("offers",/^#offers\/category_id=$/,"/groups/[:group_id]/offers"),c("offers",/^#offers\/category_id=(\d+)$/,"/groups/[:group_id]/offers?category_id=[:1]"),c("offers",/^#offers\/category_id=(\d+)\/page=(\d+)$/,"/groups/[:group_id]/offers?category_id=[:1]&page=[:2]"),c("offers",/^#offers\/neighborhood_id=$/,"/groups/[:group_id]/offers"),c("offers",/^#offers\/neighborhood_id=(\d+)$/,"/groups/[:group_id]/offers?neighborhood_id=[:1]"),c("offers",/^#offers\/neighborhood_id=(\d+)\/page=(\d+)$/,"/groups/[:group_id]/offers?neighborhood_id=[:1]&page=[:2]"),c("people",/^#people$/,"/groups/[:group_id]/memberships"),c("people",/^#people\/category_id=$/,"/groups/[:group_id]/memberships"),c("people",/^#people\/category_id=(\d+)$/,"/groups/[:group_id]/memberships?category_id=[:1]"),c("people",/^#people\/category_id=(\d+)\/page=(\d+)$/,"/groups/[:group_id]/memberships?category_id=[:1]&page=[:2]"),c("people",/^#people\/neighborhood_id=$/,"/groups/[:group_id]/memberships"),c("people",/^#people\/neighborhood_id=(\d+)$/,"/groups/[:group_id]/memberships?neighborhood_id=[:1]"),c("people",/^#people\/neighborhood_id=(\d+)\/page=(\d+)$/,"/groups/[:group_id]/memberships?neighborhood_id=[:1]&page=[:2]"),$(window).hashchange(function(){var a=location.hash,b="",c="",e=[];if(a.length!=0){var f=$("#tabs");e=d(a),c=e[0],b=e[1],"#tab_offers"==c?b+=g(OSCURRENCY.offers_mode,b):"#tab_requests"==c&&(b+=g(OSCURRENCY.reqs_mode,b)),c!=OSCURRENCY.tab&&f.tabs("select",c),b.length!=0&&$.getScript(b)}}),$(document).bind("ajaxStart",function(){$("span.wait").show()}),$(document).bind("ajaxStop",function(){$("span.wait").hide(),OSCURRENCY.post_allowed=!0}),$("input#bid_expiration_date").live("focus",function(){$(this).datepicker({buttonImage:"/images/calendar.gif",buttonImageOnly:!0,dateFormat:"yy-mm-dd"})}),$("input#req_due_date").live("focus",function(){$(this).datepicker({buttonImage:"/images/calendar.gif",buttonImageOnly:!0,dateFormat:"yy-mm-dd"})}),$("input#offer_expiration_date").live("focus",function(){$(this).datepicker({buttonImage:"/images/calendar.gif",buttonImageOnly:!0,dateFormat:"yy-mm-dd"})}),$(".edit_member_preference, #new_bid, .edit_bid, #new_req, #edit_req, #new_offer, #edit_offer, #new_topic, #new_post, #new_exchange, #new_wall_post, #new_message").live("submit",function(){return OSCURRENCY.post_allowed?(OSCURRENCY.post_allowed=!1,$.post($(this).attr("action"),$(this).serialize(),null,"script")):alert("request is being processed..."),!1}),$(".search_form").live("submit",function(){return $.get($(this).attr("action"),$(this).serialize(),null,"script"),!1}),$(".add_to_memberships").live("click",function(){if(confirm("Are you sure?")){id_name=$(this).children("a").attr("id"),$(this).hide();var a=id_name=="leave_group"?{_method:"delete"}:{};$.post($(this).children("a").attr("href"),a,null,"script")}return!1}),$(".delete_topic, .delete_post, .delete_req, .delete_offer").live("click",function(){if(confirm("Delete?")){var a={_method:"delete"};$.post($(this).attr("href"),a,null,"script")}return!1}),$(".deactivate_req").live("click",function(){var a={_method:"deactivate"};return $.post($(this).attr("href"),a,null,"script"),!1}),$("a.pay_now").live("click",function(){return window.location.hash=f(this.href),!1}),$(".pagination a").live("click",function(){return str=f(this.href),str=str.replace(/memberships/,"people"),window.location.hash=str,!1}),$("a[href="+OSCURRENCY.tab_prefix+"home]").bind("click",function(){window.location.hash="#home"}),$("a[href="+OSCURRENCY.tab_prefix+"forum]").bind("click",function(){$("#forum_form").html(""),window.location.hash="#forum"}),$("a[href="+OSCURRENCY.tab_prefix+"requests]").bind("click",function(){window.location.hash="#requests"}),$("a[href="+OSCURRENCY.tab_prefix+"offers]").bind("click",function(){window.location.hash="#offers"}),$("a[href="+OSCURRENCY.tab_prefix+"exchanges]").bind("click",function(){window.location.hash="#exchanges"}),$("a[href="+OSCURRENCY.tab_prefix+"people]").bind("click",function(){window.location.hash="#people"}),$(".category_filter #req_category_ids").live("change",function(){window.location.hash="#requests/category_id="+this.value}),$(".category_filter #offer_category_ids").live("change",function(){window.location.hash="#offers/category_id="+this.value}),$(".category_filter #person_category_ids").live("change",function(){window.location.hash="#people/category_id="+this.value}),$(".neighborhood_filter #req_neighborhood_ids").live("change",function(){window.location.hash="#requests/neighborhood_id="+this.value}),$(".neighborhood_filter #offer_neighborhood_ids").live("change",function(){window.location.hash="#offers/neighborhood_id="+this.value}),$(".neighborhood_filter #person_neighborhood_ids").live("change",function(){window.location.hash="#people/neighborhood_id="+this.value}),$("a.show-follow").live("click",function(){return window.location.hash=f(this.href),!1}),$("a.email-link").live("click",function(){return window.location.hash=f(this.href),!1}),$.fn.make_filter_visible=function(){$(this).parent().children().removeClass("filter_selected"),$(this).addClass("filter_selected")},$(".toggle-category").live("click",function(){return $(this).make_filter_visible(),$("span.category_filter").show(),$("span.neighborhood_filter").hide(),!1}),$(".toggle-neighborhood").live("click",function(){return $(this).make_filter_visible(),$("span.category_filter").hide(),$("span.neighborhood_filter").show(),!1}),$(".toggle-active-offers").live("click",function(){return $(this).make_filter_visible(),h(""),!1}),$(".toggle-all-offers").live("click",function(){return $(this).make_filter_visible(),h("all"),!1}),$(".toggle-active-reqs").live("click",function(){return $(this).make_filter_visible(),k(""),!1}),$(".toggle-all-reqs").live("click",function(){return $(this).make_filter_visible(),k("all"),!1}),$(window).trigger("hashchange")})